<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Upload Berkas Pendaftaran Wisuda - Polinela</title>
  <link rel="shortcut icon" href="/images/logopolinela.png" type="image/png">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Poppins', sans-serif;
      background: #F5F7FA;
    }
    
    .navbar-custom {
      background: #0047AB;
      padding: 1rem 0;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    
    .navbar-brand {
      color: white !important;
      font-weight: 600;
      font-size: 1.1rem;
    }
    
    .navbar-custom .nav-link {
      color: white !important;
      font-weight: 500;
      margin: 0 1rem;
    }
    
    .user-avatar {
      width: 40px;
      height: 40px;
      background: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #0047AB;
      font-weight: 600;
    }
    
    .main-content {
      padding: 2rem 0;
      min-height: calc(100vh - 80px);
    }
    
    .page-title {
      font-size: 2rem;
      font-weight: 700;
      color: #333;
      margin-bottom: 0.5rem;
    }
    
    .page-subtitle {
      color: #666;
      margin-bottom: 2rem;
    }
    
    .progress-tracker {
      background: white;
      border-radius: 15px;
      padding: 2rem;
      box-shadow: 0 2px 15px rgba(0,0,0,0.08);
      margin-bottom: 2rem;
    }
    
    .progress-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1.5rem;
    }
    
    .progress-title {
      font-size: 1.1rem;
      font-weight: 600;
      color: #333;
    }
    
    .progress-status {
      color: #0047AB;
      font-weight: 600;
    }
    
    .progress-bar-custom {
      height: 8px;
      background: #E5E7EB;
      border-radius: 10px;
      overflow: hidden;
    }
    
    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #0047AB 0%, #0066FF 100%);
      border-radius: 10px;
      transition: width 0.5s ease;
    }
    
    .upload-card {
      background: white;
      border-radius: 12px;
      padding: 1.5rem;
      margin-bottom: 1.5rem;
      border: 2px solid #E5E7EB;
      transition: all 0.3s;
    }
    
    .upload-card.uploaded {
      border-color: #10B981;
      background: #ECFDF5;
    }
    
    .upload-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 0.5rem;
    }
    
    .upload-info {
      display: flex;
      align-items: center;
      gap: 1rem;
      flex: 1;
    }
    
    .upload-icon {
      width: 50px;
      height: 50px;
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
    }
    
    .upload-icon.success {
      background: #D1FAE5;
      color: #065F46;
    }
    
    .upload-icon.default {
      background: #F3F4F6;
      color: #6B7280;
    }
    
    .upload-title {
      font-size: 1.1rem;
      font-weight: 600;
      color: #333;
      margin-bottom: 0.3rem;
    }
    
    .upload-status-badge {
      font-size: 0.85rem;
      padding: 0.25rem 0.75rem;
      border-radius: 20px;
      font-weight: 600;
    }
    
    .badge-success {
      background: #D1FAE5;
      color: #065F46;
    }
    
    .upload-filename {
      color: #666;
      font-size: 0.9rem;
      margin-top: 0.5rem;
    }
    
    .btn-upload {
      background: #0047AB;
      color: white;
      border: none;
      padding: 0.5rem 1.5rem;
      border-radius: 8px;
      font-weight: 600;
      transition: all 0.3s;
      white-space: nowrap;
    }
    
    .btn-upload:hover {
      background: #003380;
    }
    
    .btn-change {
      background: white;
      color: #0047AB;
      border: 2px solid #0047AB;
      padding: 0.5rem 1.5rem;
      border-radius: 8px;
      font-weight: 600;
      white-space: nowrap;
    }
    
    .submit-section {
      background: white;
      border-radius: 15px;
      padding: 2rem;
      box-shadow: 0 2px 15px rgba(0,0,0,0.08);
      text-align: center;
    }
    
    .btn-submit {
      background: #0047AB;
      color: white;
      border: none;
      padding: 1rem 3rem;
      border-radius: 10px;
      font-weight: 700;
      font-size: 1.1rem;
      transition: all 0.3s;
    }
    
    .btn-submit:hover {
      background: #003380;
      transform: translateY(-3px);
      box-shadow: 0 5px 20px rgba(0,71,171,0.3);
    }
    
    .btn-submit:disabled {
      background: #9CA3AF;
      cursor: not-allowed;
      transform: none;
    }
    
    input[type="file"] {
      display: none;
    }
    
    @media (max-width: 768px) {
      .upload-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 1rem;
      }
      
      .btn-upload, .btn-change {
        width: 100%;
      }
    }
  </style>
</head>
<body>

<!-- NAVBAR -->
<nav class="navbar navbar-expand-lg navbar-custom">
  <div class="container">
    <a class="navbar-brand" href="/mahasiswa/dashboard">
      <i class="fas fa-graduation-cap me-2"></i>Dashboard Mahasiswa
    </a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
      <span class="navbar-toggler-icon" style="filter: brightness(0) invert(1);"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav ms-auto align-items-center">
        <li class="nav-item">
          <a class="nav-link" href="/mahasiswa/dashboard">Dashboard</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/auth/logout">Logout</a>
        </li>
        <li class="nav-item ms-3">
          <div class="user-avatar"><%= mahasiswa.nama.charAt(0).toUpperCase() %></div>
        </li>
      </ul>
    </div>
  </div>
</nav>

<!-- MAIN CONTENT -->
<div class="main-content">
  <div class="container">
    <h1 class="page-title">Unggah Berkas Pendaftaran Wisuda</h1>
    <p class="page-subtitle">
      Mohon unggah semua dokumen yang diperlukan. Format file yang diizinkan adalah PDF, JPG, PNG dengan ukuran 
      maksimal 2 MB per file.
    </p>
    
    <!-- Progress Tracker -->
    <div class="progress-tracker">
      <div class="progress-header">
        <div class="progress-title">Progres Kelengkapan</div>
        <div class="progress-status"><span id="uploadedCount">0</span>/8 Berkas Lengkap</div>
      </div>
      <div class="progress-bar-custom">
        <div class="progress-fill" id="progressFill" style="width: 0%"></div>
      </div>
    </div>
    
    <!-- Form Upload -->
    <form action="/mahasiswa/submit-pendaftaran" method="POST" enctype="multipart/form-data" id="uploadForm">
      
      <!-- KTP -->
      <div class="upload-card" id="card-ktp">
        <div class="upload-header">
          <div class="upload-info">
            <div class="upload-icon default" id="icon-ktp">
              <i class="fas fa-id-card"></i>
            </div>
            <div>
              <div class="upload-title">KTP (Kartu Tanda Penduduk)</div>
              <span class="upload-status-badge d-none" id="badge-ktp">Belum diunggah</span>
              <div class="upload-filename" id="filename-ktp">Belum ada file yang diunggah.</div>
            </div>
          </div>
          <button type="button" class="btn-upload" onclick="document.getElementById('file-ktp').click()">
            Pilih File
          </button>
        </div>
        <input type="file" id="file-ktp" name="ktp" accept=".pdf,.jpg,.jpeg,.png" onchange="handleFileSelect(this, 'ktp')">
      </div>
      
      <!-- KK -->
      <div class="upload-card" id="card-kk">
        <div class="upload-header">
          <div class="upload-info">
            <div class="upload-icon default" id="icon-kk">
              <i class="fas fa-users"></i>
            </div>
            <div>
              <div class="upload-title">KK (Kartu Keluarga)</div>
              <span class="upload-status-badge d-none" id="badge-kk">Belum diunggah</span>
              <div class="upload-filename" id="filename-kk">Belum ada file yang diunggah.</div>
            </div>
          </div>
          <button type="button" class="btn-upload" onclick="document.getElementById('file-kk').click()">
            Pilih File
          </button>
        </div>
        <input type="file" id="file-kk" name="kk" accept=".pdf,.jpg,.jpeg,.png" onchange="handleFileSelect(this, 'kk')">
      </div>
      
      <!-- KTM -->
      <div class="upload-card" id="card-ktm">
        <div class="upload-header">
          <div class="upload-info">
            <div class="upload-icon default" id="icon-ktm">
              <i class="fas fa-address-card"></i>
            </div>
            <div>
              <div class="upload-title">KTM (Kartu Tanda Mahasiswa)</div>
              <span class="upload-status-badge d-none" id="badge-ktm">Belum diunggah</span>
              <div class="upload-filename" id="filename-ktm">Belum ada file yang diunggah.</div>
            </div>
          </div>
          <button type="button" class="btn-upload" onclick="document.getElementById('file-ktm').click()">
            Pilih File
          </button>
        </div>
        <input type="file" id="file-ktm" name="ktm" accept=".pdf,.jpg,.jpeg,.png" onchange="handleFileSelect(this, 'ktm')">
      </div>
      
      <!-- Transkrip -->
      <div class="upload-card" id="card-transkrip">
        <div class="upload-header">
          <div class="upload-info">
            <div class="upload-icon default" id="icon-transkrip">
              <i class="fas fa-file-alt"></i>
            </div>
            <div>
              <div class="upload-title">Transkrip Nilai</div>
              <span class="upload-status-badge d-none" id="badge-transkrip">Belum diunggah</span>
              <div class="upload-filename" id="filename-transkrip">Belum ada file yang diunggah.</div>
            </div>
          </div>
          <button type="button" class="btn-upload" onclick="document.getElementById('file-transkrip').click()">
            Pilih File
          </button>
        </div>
        <input type="file" id="file-transkrip" name="transkrip" accept=".pdf,.jpg,.jpeg,.png" onchange="handleFileSelect(this, 'transkrip')">
      </div>
      
      <!-- Foto -->
      <div class="upload-card" id="card-foto">
        <div class="upload-header">
          <div class="upload-info">
            <div class="upload-icon default" id="icon-foto">
              <i class="fas fa-camera"></i>
            </div>
            <div>
              <div class="upload-title">Pas Foto (4x6, Latar Merah)</div>
              <span class="upload-status-badge d-none" id="badge-foto">Belum diunggah</span>
              <div class="upload-filename" id="filename-foto">Belum ada file yang diunggah.</div>
            </div>
          </div>
          <button type="button" class="btn-upload" onclick="document.getElementById('file-foto').click()">
            Pilih File
          </button>
        </div>
        <input type="file" id="file-foto" name="foto" accept=".jpg,.jpeg,.png" onchange="handleFileSelect(this, 'foto')">
      </div>
      
      <!-- TOEIC -->
      <div class="upload-card" id="card-toeic">
        <div class="upload-header">
          <div class="upload-info">
            <div class="upload-icon default" id="icon-toeic">
              <i class="fas fa-language"></i>
            </div>
            <div>
              <div class="upload-title">Sertifikat TOEIC</div>
              <span class="upload-status-badge d-none" id="badge-toeic">Belum diunggah</span>
              <div class="upload-filename" id="filename-toeic">Belum ada file yang diunggah.</div>
            </div>
          </div>
          <button type="button" class="btn-upload" onclick="document.getElementById('file-toeic').click()">
            Pilih File
          </button>
        </div>
        <input type="file" id="file-toeic" name="toeic" accept=".pdf,.jpg,.jpeg,.png" onchange="handleFileSelect(this, 'toeic')">
      </div>
      
      <!-- Surat Bebas Tanggungan -->
      <div class="upload-card" id="card-bebas-tanggungan">
        <div class="upload-header">
          <div class="upload-info">
            <div class="upload-icon default" id="icon-bebas-tanggungan">
              <i class="fas fa-file-signature"></i>
            </div>
            <div>
              <div class="upload-title">Surat Bebas Tanggungan</div>
              <span class="upload-status-badge d-none" id="badge-bebas-tanggungan">Belum diunggah</span>
              <div class="upload-filename" id="filename-bebas-tanggungan">Belum ada file yang diunggah.</div>
            </div>
          </div>
          <button type="button" class="btn-upload" onclick="document.getElementById('file-bebas-tanggungan').click()">
            Pilih File
          </button>
        </div>
        <input type="file" id="file-bebas-tanggungan" name="bebas_tanggungan" accept=".pdf,.jpg,.jpeg,.png" onchange="handleFileSelect(this, 'bebas-tanggungan')">
      </div>
      
      <!-- Cover TA -->
      <div class="upload-card" id="card-cover-ta">
        <div class="upload-header">
          <div class="upload-info">
            <div class="upload-icon default" id="icon-cover-ta">
              <i class="fas fa-book"></i>
            </div>
            <div>
              <div class="upload-title">Cover Tugas Akhir</div>
              <span class="upload-status-badge d-none" id="badge-cover-ta">Belum diunggah</span>
              <div class="upload-filename" id="filename-cover-ta">Belum ada file yang diunggah.</div>
            </div>
          </div>
          <button type="button" class="btn-upload" onclick="document.getElementById('file-cover-ta').click()">
            Pilih File
          </button>
        </div>
        <input type="file" id="file-cover-ta" name="cover_ta" accept=".pdf,.jpg,.jpeg,.png" onchange="handleFileSelect(this, 'cover-ta')">
      </div>
      
      <!-- Submit Button -->
      <div class="submit-section">
        <p class="text-muted mb-3">Pastikan semua berkas sudah lengkap dan benar sebelum mengajukan pendaftaran.</p>
        <button type="submit" class="btn-submit" id="btnSubmit" disabled>
          <i class="fas fa-paper-plane me-2"></i>Ajukan Pendaftaran
        </button>
      </div>
    </form>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<script>
  let uploadedFiles = {
    ktp: false,
    kk: false,
    ktm: false,
    transkrip: false,
    foto: false,
    toeic: false,
    'bebas-tanggungan': false,
    'cover-ta': false
  };
  
  function handleFileSelect(input, docType) {
    const file = input.files[0];
    if (!file) return;
    
    // Validate file size (2MB max)
    if (file.size > 2 * 1024 * 1024) {
      Swal.fire({
        icon: 'error',
        title: 'File Terlalu Besar',
        text: 'Ukuran file maksimal 2 MB',
        confirmButtonColor: '#0047AB'
      });
      input.value = '';
      return;
    }
    
    // Update UI
    const card = document.getElementById(`card-${docType}`);
    const icon = document.getElementById(`icon-${docType}`);
    const badge = document.getElementById(`badge-${docType}`);
    const filename = document.getElementById(`filename-${docType}`);
    
    card.className = 'upload-card uploaded';
    icon.className = 'upload-icon success';
    icon.innerHTML = '<i class="fas fa-check-circle"></i>';
    badge.className = 'upload-status-badge badge-success';
    badge.textContent = 'Siap Diunggah';
    badge.classList.remove('d-none');
    filename.textContent = `${file.name} (${(file.size / 1024).toFixed(0)} KB)`;
    
    uploadedFiles[docType] = true;
    updateProgress();
  }
  
  function updateProgress() {
    const total = Object.keys(uploadedFiles).length;
    const uploaded = Object.values(uploadedFiles).filter(Boolean).length;
    const percentage = (uploaded / total) * 100;
    
    document.getElementById('uploadedCount').textContent = uploaded;
    document.getElementById('progressFill').style.width = percentage + '%';
    
    // Enable submit button if all files uploaded
    document.getElementById('btnSubmit').disabled = uploaded < total;
  }
  
  // Initialize progress
  updateProgress();
  
  // Form submit
  document.getElementById('uploadForm').addEventListener('submit', function(e) {
    e.preventDefault();
    
    Swal.fire({
      title: 'Konfirmasi Pendaftaran',
      text: 'Apakah Anda yakin semua berkas sudah benar?',
      icon: 'question',
      showCancelButton: true,
      confirmButtonColor: '#0047AB',
      cancelButtonColor: '#6B7280',
      confirmButtonText: 'Ya, Ajukan!',
      cancelButtonText: 'Batal'
    }).then((result) => {
      if (result.isConfirmed) {
        // Submit form
        this.submit();
      }
    });
  });
</script>

</body>
</html>
